<!doctype html>
<html>

<head>

<!-- <script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script> -->
<!-- 这个是直接用真正的websocket的样例，不用跨域 -->
<script src="sockjs-0.js"></script>
<script src="stomp.js"></script>
</head>
<body>
  <script>
    // use SockJS implementation instead of the browser's native implementation
    var login = "gooduser";
    var passcode= "passwd1";
    //var host = "dev1.etgbroker.com";
    var host = "localhost"
    // var url = "ws://localhost:61613/stomp";
    // var url = "ws://dev1.etgbroker.com:61615/stomp";
    // var url = "wss://price.etgbroker.com:61616/stomp";
    var url = "ws://rtprice.invhero.com:61613/stomp";
	// var url = "ws://rtprice.invhero.com:61614/stomp";
	// var url = "ws://114.113.20.51:61614/stomp";   // 197
	//var url = "ws://114.113.20.50:61614/stomp";   // 196
    //var url = "ws://45.121.52.233:61614/stomp";   // 195
    
    var client = Stomp.client(url);
    var i = 0;
    var onmessage = function(message) {
        
        console.log(message);
        i+=1;
        if (i > 10) {
            client.unsubscribe(sub1);

        }
	// document.getElementById('input1');
        document.getElementById('input1').value = message;
        // alert(message);
    }
    var sub1="";
    var sub2="";
    var connect_callback = function() {
        console.log("stomp connected");
        //var sub1 = client.subscribe("quote.real_default.BTCUSD.v2", onmessage);
        //var sub2 = client.subscribe("quote.real_default.USDJPY.v2", onmessage);
        //var sub3 = client.subscribe("quote.real_default.EURUSD.v2", onmessage);
	
	sub1 = client.subscribe("quote.demo_default.BTCUSD?format=v2&throttle=1", onmessage);
	sub2 = client.subscribe("quote.demo_default.EURUSD?format=v2&throttle=1", onmessage);
        console.log("sub1 is " + sub1);
        console.log("sub2 is " + sub2);
         
    };
  var error_callback = function(error) {
    // display the error's message header:
    console.log(error);
  };
  client.connect(login, passcode, connect_callback, error_callback, host);
  
  // var sub2 = client.subscribe("queue/another", onmessage);
  
  </script>
  <input id='input1' />
</body>
</html>
